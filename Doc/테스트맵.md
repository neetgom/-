graph LR
    %% 스타일 정의 (파란색 테마)
    classDef rootNode fill:#005f99,stroke:#003f66,stroke-width:4px,color:#fff,rx:10,ry:10,font-weight:bold;
    classDef mainNode fill:#4da6ff,stroke:#005f99,stroke-width:2px,color:#fff,rx:10,ry:10;
    classDef subNode fill:#b3d9ff,stroke:#4da6ff,stroke-width:2px,color:#003366,rx:10,ry:10;
    classDef leafNode fill:#e6f2ff,stroke:#b3d9ff,stroke-width:1px,color:#00264d,rx:5,ry:5;

    %% 루트 노드
    Root[원신 6.3<br/>달 결정 기능 테스트]:::rootNode

    %% 1. 발동 조건
    Root --> C1[1. 발동 조건]:::mainNode
    C1 --> C1_1(1.1 물+바위 반응):::subNode
    C1_1 --> C1_1_1[1.1.1 반응 즉시 발동]:::leafNode
    C1_1 --> C1_1_2[1.1.2 원소 부착 순서]:::leafNode
    
    C1 --> C1_2(1.2 방해 요소):::subNode
    C1_2 --> C1_2_1[1.2.1 타 원소 개입]:::leafNode
    C1_2 --> C1_2_2[1.2.2 다중 원소 처리]:::leafNode

    %% 2. 조각 생성
    Root --> C2[2. 조각 생성]:::mainNode
    C2 --> C2_1(2.1 달빛 조각 생성):::subNode
    C2_1 --> C2_1_1[2.1.1 정상 생성 확인]:::leafNode
    C2_1 --> C2_1_2[2.1.2 생성 위치 유효성]:::leafNode
    C2_1 --> C2_1_3[2.1.3 지속 시간 및 소멸]:::leafNode

    %% 3. 조각 수집
    Root --> C3[3. 조각 수집]:::mainNode
    C3 --> C3_1(3.1 획득):::subNode
    C3_1 --> C3_1_1[3.1.1 접근 시 자동 획득]:::leafNode
    C3_1 --> C3_1_2[3.1.2 Active 캐릭터만]:::leafNode
    
    C3 --> C3_2(3.2 누적):::subNode
    C3_2 --> C3_2_1[3.2.1 최대 3개 누적]:::leafNode
    C3_2 --> C3_2_2[3.2.2 초과 획득 처리]:::leafNode

    %% 4. 자동 공격
    Root --> C4[4. 자동 공격]:::mainNode
    C4 --> C4_1(4.1 3스택 발동):::subNode
    C4_1 --> C4_1_1[4.1.1 즉시 발동 확인]:::leafNode
    C4_1 --> C4_1_2[4.1.2 이펙트 출력]:::leafNode
    
    C4 --> C4_2(4.2 타겟팅):::subNode
    C4_2 --> C4_2_1[4.2.1 유도 성능 확인]:::leafNode
    C4_2 --> C4_2_2[4.2.2 다수 적 타겟팅]:::leafNode
    C4_2 --> C4_2_3[4.2.3 적 없을 때 처리]:::leafNode

    %% 5. 데미지
    Root --> C5[5. 데미지]:::mainNode
    C5 --> C5_1(5.1 수치 검증):::subNode
    C5_1 --> C5_1_1[5.1.1 원마 비례 상승]:::leafNode
    C5_1 --> C5_1_2[5.1.2 치명타 적용]:::leafNode
    C5_1 --> C5_1_3[5.1.3 내성 및 증폭 계산]:::leafNode

    %% 6. 기타
    Root --> C6[6. 기타]:::mainNode
    C6 --> C6_1(6.1 속성 판정):::subNode
    C6_1 --> C6_1_1[6.1.1 바위 창조물 인식]:::leafNode
    C6_1 --> C6_1_2[6.1.2 타 스킬 상호작용]:::leafNode
